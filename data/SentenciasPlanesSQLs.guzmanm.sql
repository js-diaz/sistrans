--PLANES DE CONSULTA
--RFC9P ESC 4
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-03-02 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND  FECHA_FIN<TO_DATE('2017-11-25', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY ID_PRODUCTO DESC, MESA ASC, TIEMPO ASC;
--RFC10P esc2
SELECT NOMBRE_CATEGORIA, IDUSUARIO,COUNT(*)  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE<'Nlounge' AND NOMBRE_RESTAURANTE>'Nlounge' AND FECHA<=TO_DATE('2017-07-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY NOMBRE_CATEGORIA, IDUSUARIO  ORDER BY COUNT(*) DESC, IDUSUARIO ASC;
--RFC9M ESC 3
SELECT NOMBRE_MENU,VALOR,ENTREGADO,NOMBRE_RESTAURANTE,PAGADA,PRECIO,COSTO,MESA,FECHA,NOMBRE_CATEGORIA,IDUSUARIO,NUMEROCUENTA,CANTIDAD,U.NOMBRE  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2018-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND MESA=10   ORDER BY NOMBRE_MENU DESC;
--RFC10M3
SELECT VALOR,NOMBRE_MENU,ENTREGADO,PAGADA,PRECIO,COSTO,FECHA,MESA,NUMEROCUENTA,IDUSUARIO,CANTIDAD,U.NOMBRE  
FROM  PEDIDO_MENU PM, MENU M ,USUARIO U, CUENTA   
WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE AND 
U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND M.NOMBRE_RESTAURANTE = 'Nlounge' AND FECHA<=TO_DATE('2017-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND MESA=10   ORDER BY NOMBRE_MENU DESC;

SELECT IDUSUARIO,MAX(VALOR)  FROM  
(SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) ,USUARIO U, CUENTA  
WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE = 'Nlounge' AND FECHA<=TO_DATE('2017-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY IDUSUARIO HAVING NOT (MAX(VALOR)<='500') ;

SELECT MESA,COUNT(*)  FROM  PEDIDO_MENU PM, MENU M ,USUARIO U, CUENTA   WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND PM.NOMBRE_RESTAURANTE<'Nlounge' AND PM.NOMBRE_RESTAURANTE>'Nlounge'  AND FECHA<=TO_DATE('2017-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY MESA  ORDER BY MESA DESC, COUNT(*) DESC


--OTROS
--RFC9P1
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE  LIKE 'Wikibox' AND FECHA<=TO_DATE('2016-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-10-23 07:00:00', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY PRECIO DESC;
--RFC9P2
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-08-13 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-08-12 07:00:00', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY PRECIO DESC;
--RFC9P3
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE  LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY PRECIO DESC, COSTO DESC;
--RFC10P1
SELECT TIPO,COUNT(*)  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-07-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-06-08 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY TIPO HAVING COUNT(*)>10 ORDER BY TIPO DESC;

--RFC10P3
SELECT IDUSUARIO,AVG(VALOR)  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-07-09 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY IDUSUARIO HAVING AVG(VALOR)<=1000 ;

--RFC9M1
SELECT NOMBRE_CATEGORIA,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY NOMBRE_CATEGORIA  ORDER BY NOMBRE_CATEGORIA ASC;

--RFC9M2
 SELECT IDUSUARIO,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY IDUSUARIO  ORDER BY IDUSUARIO ASC;

--RFC10M1
 SELECT MESA,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY MESA  ORDER BY MESA DESC, COUNT(*) DESC;

--RFC10M2
 SELECT VALOR,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-08-02 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-07-26 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY VALOR  ORDER BY VALOR DESC;


--RFC1
 SELECT TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAG_WEB,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,DESCRIPCION,ID_PRODUCTO,NOMBRE_CATEGORIA,NOMBRE,NOMBRE_ZONA,ID_REPRESENTANTE
 FROM (SELECT PRODUCTO.NOMBRE, PRODUCTO.TIPO, PRODUCTO.PERSONALIZABLE, PRODUCTO.TRADUCCION, PRODUCTO.DESCRIPCION, PRODUCTO.TIEMPO, INFO_PROD_REST.*, RESTAURANTE.PAG_WEB, RESTAURANTE.NOMBRE_ZONA, RESTAURANTE.ID_REPRESENTANTE, CATEGORIA_PRODUCTO.NOMBRE_CATEGORIA 
        FROM PRODUCTO, RESTAURANTE,  INFO_PROD_REST, CATEGORIA_PRODUCTO WHERE PRODUCTO.ID = CATEGORIA_PRODUCTO.ID_PRODUCTO AND PRODUCTO.ID = INFO_PROD_REST.ID_PRODUCTO AND RESTAURANTE.NOMBRE = INFO_PROD_REST.NOMBRE_RESTAURANTE)    
 WHERE NOT (PRECIO=COSTO)   ORDER BY ID_PRODUCTO DESC;
 --CAMBIOS P.NOMBRE, I.ID_PRODUCTO
  SELECT TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAG_WEB,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,DESCRIPCION,I.ID_PRODUCTO,NOMBRE_CATEGORIA,P.NOMBRE,NOMBRE_ZONA,ID_REPRESENTANTE
 FROM PRODUCTO P, RESTAURANTE,  INFO_PROD_REST I, CATEGORIA_PRODUCTO
 WHERE P.ID = CATEGORIA_PRODUCTO.ID_PRODUCTO AND P.ID = I.ID_PRODUCTO AND 
 RESTAURANTE.NOMBRE = I.NOMBRE_RESTAURANTE AND NOT (PRECIO=COSTO)   ORDER BY ID_PRODUCTO DESC;
 

 --RFC2
SELECT P.NOMBRE_MENU,CAPACIDAD,INGRESOESPECIAL,ABIERTAACTUALMENTE,PAG_WEB,PAGADA,Z.NOMBRE,NOMBRE_RESTAURANTE,CAPACIDADOCUPADA,FECHA,
    MESA,IDUSUARIO,NUMERO_CUENTA,CANTIDAD,P.ID_PRODUCTO,ID_REPRESENTANTE 
SELECT CAPACIDAD,INGRESOESPECIAL,ABIERTAACTUALMENTE,PAG_WEB,PAGADA,NOMBRE_RESTAURANTE,CAPACIDADOCUPADA,FECHA,MESA,IDUSUARIO,NUMERO_CUENTA,CANTIDAD,NOMBRE,ID_REPRESENTANTE,Z.NOMBRE,P.ID_PRODUCTO,P.NOMBRE_MENU  FROM ZONA Z, RESTAURANTE, CUENTA,  (SELECT * FROM PEDIDO_PROD NATURAL FULL OUTER JOIN PEDIDO_MENU) P  WHERE (FECHA>=TO_DATE('2017-04-08', 'yyyy-MM-dd hh24:mi:ss') AND FECHA<=TO_DATE('2018-01-01', 'yyyy-MM-dd hh24:mi:ss'))   ORDER BY CAPACIDAD DESC, FECHA ASC, NOMBRE_RESTAURANTE ASC;
WHERE Z.NOMBRE LIKE RESTAURANTE.NOMBRE_ZONA AND P.NOMBRE_RESTAURANTE LIKE RESTAURANTE.NOMBRE  AND CUENTA.NUMEROCUENTA LIKE P.NUMERO_CUENTA
    AND (FECHA>=TO_DATE('2017-04-08', 'yyyy-MM-dd hh24:mi:ss') AND FECHA<=TO_DATE('2018-01-01', 'yyyy-MM-dd hh24:mi:ss'))   
ORDER BY CAPACIDAD DESC, FECHA ASC, NOMBRE_RESTAURANTE ASC;

SELECT NOMBRE_MENU,CAPACIDAD,INGRESOESPECIAL,ABIERTAACTUALMENTE,PAG_WEB,PAGADA,NOMBRE_RESTAURANTE,CAPACIDADOCUPADA,FECHA,MESA,IDUSUARIO,NUMERO_CUENTA,CANTIDAD,ID_PRODUCTO,NOMBRE,ID_REPRESENTANTE 
FROM (SELECT ZONA.*, RESTAURANTE.PAG_WEB, RESTAURANTE.ID_REPRESENTANTE, P.*,CUENTA.FECHA,CUENTA.IDUSUARIO, CUENTA.MESA , CUENTA.PAGADA
FROM ZONA, RESTAURANTE,  CUENTA,  (SELECT * FROM PEDIDO_PROD NATURAL FULL OUTER JOIN PEDIDO_MENU) P WHERE ZONA.NOMBRE LIKE RESTAURANTE.NOMBRE_ZONA AND P.NOMBRE_RESTAURANTE LIKE RESTAURANTE.NOMBRE  AND CUENTA.NUMEROCUENTA LIKE P.NUMERO_CUENTA)
WHERE (FECHA>=TO_DATE('2017-04-08', 'yyyy-MM-dd hh24:mi:ss') AND FECHA<=TO_DATE('2018-01-01', 'yyyy-MM-dd hh24:mi:ss'))   
ORDER BY CAPACIDAD DESC, FECHA ASC, NOMBRE_RESTAURANTE ASC;
--RFC8
SELECT B.NOMBRE_RESTAURANTE, B.NOMBRE_MENU AS PRODUCTO, NVL(SUM(PRECIO)*SUM(CASE WHEN C.IDUSUARIO IS NULL THEN 0 ELSE B.CANTIDAD END),0) 
AS TOTALASIGNADO, NVL(SUM(CASE WHEN C.IDUSUARIO IS NULL THEN 0 ELSE B.CANTIDAD END),0) AS CANTIDADASIGNADA,   
NVL(SUM(PRECIO)*SUM(CASE WHEN C.IDUSUARIO IS NOT NULL THEN 0 ELSE B.CANTIDAD END),0) AS TOTALNOASIGNADO, 
NVL(SUM(CASE WHEN C.IDUSUARIO IS NOT NULL THEN 0 ELSE B.CANTIDAD END),0) AS CANTIDADNOASIGNADA  
FROM MENU A LEFT OUTER JOIN PEDIDO_MENU B ON A.NOMBRE=B.NOMBRE_MENU AND A.NOMBRE_RESTAURANTE=B.NOMBRE_RESTAURANTE 
LEFT OUTER JOIN CUENTA C ON B.NUMERO_CUENTA=C.NUMEROCUENTA, RESTAURANTE D		
WHERE PAGADA='1' AND D.NOMBRE LIKE B.NOMBRE_RESTAURANTE AND B.NOMBRE_RESTAURANTE LIKE 'Topicstorm'  group by B.NOMBRE_RESTAURANTE,B.NOMBRE_MENU ORDER BY B.NOMBRE_RESTAURANTE, B.NOMBRE_MENU; 
--CAMBIOS
SELECT B.NOMBRE_RESTAURANTE, NOMBRE_MENU AS PRODUCTO, NVL(SUM(PRECIO)*SUM(CASE WHEN C.IDUSUARIO IS NULL THEN 0 ELSE B.CANTIDAD END),0) AS TOTALASIGNADO, NVL(SUM(CASE WHEN C.IDUSUARIO IS NULL THEN 0 ELSE B.CANTIDAD END),0) AS CANTIDADASIGNADA,   NVL(SUM(PRECIO)*SUM(CASE WHEN C.IDUSUARIO IS NOT NULL THEN 0 ELSE B.CANTIDAD END),0) AS TOTALNOASIGNADO, NVL(SUM(CASE WHEN C.IDUSUARIO IS NOT NULL THEN 0 ELSE B.CANTIDAD END),0) AS CANTIDADNOASIGNADA  
FROM (MENU A LEFT OUTER JOIN PEDIDO_MENU B ON A.NOMBRE=B.NOMBRE_MENU AND A.NOMBRE_RESTAURANTE=B.NOMBRE_RESTAURANTE) LEFT OUTER JOIN CUENTA C ON B.NUMERO_CUENTA=C.NUMEROCUENTA, RESTAURANTE D
WHERE PAGADA='1' AND D.NOMBRE LIKE B.NOMBRE_RESTAURANTE group by B.NOMBRE_RESTAURANTE, NOMBRE_MENU ORDER BY NOMBRE_RESTAURANTE, NOMBRE_MENU;
--RFC7
SELECT CLIENTE,TIENEMESA,NOMBRE_MENU,ID,NOMBRE,DESCRIPCION,TRADUCCION,TIPO,NOMBRE_RESTAURANTE,CANTIDAD
FROM (SELECT USUARIO.ID AS CLIENTE,(CASE WHEN  CUENTA.MESA IS NULL THEN 0    ELSE 1 END) AS TIENEMESA ,NULL AS NOMBRE_MENU, PRODUCTO.ID, PRODUCTO.NOMBRE, PRODUCTO.DESCRIPCION, PRODUCTO.TRADUCCION, PRODUCTO.TIPO,PEDIDO_PROD.NOMBRE_RESTAURANTE,SUM(PEDIDO_PROD.CANTIDAD) AS CANTIDAD 
        FROM CUENTA,PEDIDO_PROD, PRODUCTO,USUARIO WHERE IDUSUARIO=USUARIO.ID AND CUENTA.NUMEROCUENTA LIKE PEDIDO_PROD.NUMERO_CUENTA AND CUENTA.PAGADA='1' AND PEDIDO_PROD.ID_PRODUCTO=PRODUCTO.ID GROUP BY USUARIO.ID, (CASE WHEN CUENTA.MESA IS NULL THEN 0 ELSE 1 END), NULL, PRODUCTO.ID, PRODUCTO.NOMBRE, PRODUCTO.DESCRIPCION, PRODUCTO.TRADUCCION, PRODUCTO.TIPO, PEDIDO_PROD.NOMBRE_RESTAURANTE) 
        UNION(SELECT USUARIO.ID AS CLIENTE,(CASE WHEN CUENTA.MESA IS NULL THEN 0    ELSE 1 END) AS TIENEMESA ,MENU.NOMBRE AS NOMBREMENU, PRODUCTO.ID, PRODUCTO.NOMBRE, PRODUCTO.DESCRIPCION, PRODUCTO.TRADUCCION, PRODUCTO.TIPO, MENU.NOMBRE_RESTAURANTE, SUM(PEDIDO_MENU.CANTIDAD) AS CANTIDAD 
        FROM CUENTA,PEDIDO_MENU, PRODUCTO, MENU, PERTENECE_A_MENU,USUARIO 
        WHERE IDUSUARIO=USUARIO.ID AND CUENTA.NUMEROCUENTA LIKE PEDIDO_MENU.NUMERO_CUENTA AND CUENTA.PAGADA='1' AND PEDIDO_MENU.NOMBRE_MENU LIKE MENU.NOMBRE AND PEDIDO_MENU.NOMBRE_RESTAURANTE LIKE MENU.NOMBRE_RESTAURANTE AND PERTENECE_A_MENU.NOMBRE_RESTAURANTE LIKE MENU.NOMBRE_RESTAURANTE AND PERTENECE_A_MENU.NOMBRE_MENU LIKE MENU.NOMBRE AND PRODUCTO.ID = PERTENECE_A_MENU.ID_PLATO  GROUP BY USUARIO.ID, 
            (CASE WHEN CUENTA.MESA IS NULL THEN 0 ELSE 1 END), MENU.NOMBRE, PRODUCTO.ID, PRODUCTO.NOMBRE, PRODUCTO.DESCRIPCION, PRODUCTO.TRADUCCION, PRODUCTO.TIPO, MENU.NOMBRE_RESTAURANTE) 
        ORDER BY CLIENTE,TIENEMESA,NOMBRE_MENU;


--RFC5
SELECT T.NOMBRE_ZONA, CATEGORIA_PRODUCTO.NOMBRE_CATEGORIA, T.ID,  T.CANTIDAD, (INFO_PROD_REST.COSTO*T.CANTIDAD) AS COSTOTOTAL, (INFO_PROD_REST.PRECIO* T.CANTIDAD) AS VALORTOTAL
FROM CATEGORIA_PRODUCTO, INFO_PROD_REST,
    (SELECT NOMBRE_ZONA, ID, SUM(CANTIDADTOTAL1+CANTIDADTOTAL2)AS CANTIDAD 
    FROM           
        ( SELECT NOMBRE_ZONA ,ID,NVL(CANTIDADTOTAL1,0) AS CANTIDADTOTAL1           
        FROM				  
            (SELECT RESTAURANTE.NOMBRE_ZONA AS NOMBRE_ZONA, PRODUCTO.ID AS ID, SUM(PEDIDO_MENU.CANTIDAD) AS CANTIDADTOTAL1					
                FROM PRODUCTO, PEDIDO_MENU, PERTENECE_A_MENU, RESTAURANTE, CUENTA					 
                WHERE PEDIDO_MENU.NOMBRE_MENU LIKE PERTENECE_A_MENU.NOMBRE_MENU 					 
                AND PEDIDO_MENU.NOMBRE_RESTAURANTE LIKE PERTENECE_A_MENU.NOMBRE_RESTAURANTE					
                AND RESTAURANTE.NOMBRE LIKE PEDIDO_MENU.NOMBRE_RESTAURANTE AND CUENTA.NUMEROCUENTA LIKE PEDIDO_MENU.NUMERO_CUENTA		
                AND	CUENTA.FECHA >=TO_DATE('2015-10-30 07:00:00','yyyy-MM-dd hh24:mi:ss') AND CUENTA.FECHA<=TO_DATE('2019-10-30 07:00:00','yyyy-MM-dd hh24:mi:ss')				
                AND PRODUCTO.ID = PERTENECE_A_MENU.ID_PLATO AND RESTAURANTE.NOMBRE LIKE 'Roodel'	
                GROUP BY RESTAURANTE.NOMBRE_ZONA,PRODUCTO.ID) 
        NATURAL FULL OUTER JOIN PRODUCTO  ) 
                NATURAL FULL OUTER JOIN  
                (SELECT RESTAURANTE.NOMBRE_ZONA AS NOMBRE_ZONA,PEDIDO_PROD.ID_PRODUCTO AS ID2,SUM(PEDIDO_PROD.CANTIDAD) AS CANTIDADTOTAL2 	  
                FROM PEDIDO_PROD, RESTAURANTE, CUENTA 
                WHERE PEDIDO_PROD.NOMBRE_RESTAURANTE LIKE RESTAURANTE.NOMBRE AND RESTAURANTE.NOMBRE LIKE 'Roodel'AND CUENTA.NUMEROCUENTA LIKE PEDIDO_PROD.NUMERO_CUENTA 				
                AND	CUENTA.FECHA >=TO_DATE('2015-10-30 07:00:00','yyyy-MM-dd hh24:mi:ss') AND CUENTA.FECHA<=TO_DATE('2019-10-30 07:00:00','yyyy-MM-dd hh24:mi:ss')  GROUP BY RESTAURANTE.NOMBRE_ZONA,PEDIDO_PROD.ID_PRODUCTO) 
WHERE NOMBRE_ZONA IS NOT NULL AND ID IS NOT NULL GROUP BY NOMBRE_ZONA,ID)T WHERE T.ID = CATEGORIA_PRODUCTO.ID_PRODUCTO AND INFO_PROD_REST.ID_PRODUCTO=T.ID 
GROUP BY T.NOMBRE_ZONA, CATEGORIA_PRODUCTO.NOMBRE_CATEGORIA, T.ID, (INFO_PROD_REST.PRECIO*T.CANTIDAD), T.CANTIDAD, (INFO_PROD_REST.COSTO*T.CANTIDAD) ORDER BY NOMBRE_ZONA, NOMBRE_CATEGORIA, VALORTOTAL DESC ;


SELECT NOMBRE_ZONA, CATEGORIA_PRODUCTO.NOMBRE_CATEGORIA, T.ID_PRODUCTO, (INFO_PROD_REST.COSTO*SUM(T.CANTIDAD)) AS COSTOTOTAL, (INFO_PROD_REST.PRECIO* SUM(T.CANTIDAD)) AS VALORTOTAL
FROM CATEGORIA_PRODUCTO, INFO_PROD_REST,PEDIDO_PROD T, CUENTA, RESTAURANTE
WHERE T.NOMBRE_RESTAURANTE LIKE RESTAURANTE.NOMBRE AND RESTAURANTE.NOMBRE LIKE 'Roodel'AND CUENTA.NUMEROCUENTA LIKE T.NUMERO_CUENTA 				
    AND	CUENTA.FECHA >=TO_DATE('2015-10-30 07:00:00','yyyy-MM-dd hh24:mi:ss') AND CUENTA.FECHA<=TO_DATE('2019-10-30 07:00:00','yyyy-MM-dd hh24:mi:ss') 
    AND T.ID_PRODUCTO = CATEGORIA_PRODUCTO.ID_PRODUCTO AND INFO_PROD_REST.ID_PRODUCTO=T.ID_PRODUCTO AND T.NOMBRE_RESTAURANTE=INFO_PROD_REST.NOMBRE_RESTAURANTE
GROUP BY NOMBRE_ZONA, CATEGORIA_PRODUCTO.NOMBRE_CATEGORIA, T.ID_PRODUCTO,(INFO_PROD_REST.COSTO*SUM(T.CANTIDAD)) AS COSTOTOTAL, (INFO_PROD_REST.PRECIO* SUM(T.CANTIDAD)) AS VALORTOTAL
ORDER BY NOMBRE_ZONA, NOMBRE_CATEGORIA, VALORTOTAL DESC ;





 








