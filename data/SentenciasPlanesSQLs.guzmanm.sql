--PLANES DE CONSULTA
--RFC9P ESC 4
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-03-02 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND  FECHA_FIN<TO_DATE('2017-11-25', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY ID_PRODUCTO DESC, MESA ASC, TIEMPO ASC;
--RFC10P esc2
SELECT NOMBRE_CATEGORIA, IDUSUARIO,COUNT(*)  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-07-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY NOMBRE_CATEGORIA, IDUSUARIO  ORDER BY COUNT(*) DESC, IDUSUARIO ASC;
--RFC9M ESC 3
SELECT NOMBRE_MENU,VALOR,ENTREGADO,NOMBRE_RESTAURANTE,PAGADA,PRECIO,COSTO,MESA,FECHA,NOMBRE_CATEGORIA,IDUSUARIO,NUMEROCUENTA,CANTIDAD,U.NOMBRE  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2018-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND MESA=10   ORDER BY NOMBRE_MENU DESC;
--RFC10M3
SELECT IDUSUARIO,MAX(VALOR)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE NOT LIKE 'Nlounge' AND FECHA<=TO_DATE('2018-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY IDUSUARIO HAVING NOT (MAX(VALOR)<='500') ;

--OTROS
--RFC9P1
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE  LIKE 'Wikibox' AND FECHA<=TO_DATE('2016-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-10-23 07:00:00', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY PRECIO DESC;
--RFC9P2
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-08-13 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-08-12 07:00:00', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY PRECIO DESC;
--RFC9P3
SELECT VALOR,ENTREGADO,TIEMPO,FECHA_INICIO,PERSONALIZABLE,PAGADA,CANTIDAD_MAXIMA,FECHA_FIN,NOMBRE_RESTAURANTE,TRADUCCION,DISPONIBILIDAD,PRECIO,TIPO,COSTO,MESA,FECHA,DESCRIPCION,IDUSUARIO,NUMEROCUENTA,ID_PRODUCTO,CANTIDAD,U.NOMBRE,P.NOMBRE AS NOMBRE_PRODUCTO  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE  LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss')   ORDER BY PRECIO DESC, COSTO DESC;
--RFC10P1
SELECT TIPO,COUNT(*)  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-07-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-06-08 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY TIPO HAVING COUNT(*)>10 ORDER BY TIPO DESC;

--RFC10P3
SELECT IDUSUARIO,AVG(VALOR)  FROM (PEDIDO_PROD NATURAL INNER JOIN INFO_PROD_REST)NATURAL INNER JOIN CATEGORIA_PRODUCTO, PRODUCTO P,USUARIO U,  CUENTA WHERE ID_PRODUCTO=P.ID AND U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA  AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-07-09 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY IDUSUARIO HAVING AVG(VALOR)<=1000 ;

--RFC9M1
SELECT NOMBRE_CATEGORIA,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-08-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY NOMBRE_CATEGORIA  ORDER BY NOMBRE_CATEGORIA ASC;

--RFC9M2
 SELECT IDUSUARIO,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE  LIKE 'Nlounge' AND FECHA<=TO_DATE('2017-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY IDUSUARIO  ORDER BY IDUSUARIO ASC;

--RFC10M1
 SELECT MESA,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-10-30 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2016-08-07 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY MESA  ORDER BY MESA DESC, COUNT(*) DESC;

--RFC10M2
 SELECT VALOR,COUNT(*)  FROM  (SELECT PM.*, M.PRECIO, M.COSTO FROM MENU M,PEDIDO_MENU PM WHERE M.NOMBRE=PM.NOMBRE_MENU AND M.NOMBRE_RESTAURANTE=PM.NOMBRE_RESTAURANTE) NATURAL INNER JOIN CATEGORIA_MENU,USUARIO U, CUENTA   WHERE U.ID=IDUSUARIO AND NUMEROCUENTA=NUMERO_CUENTA AND NOMBRE_RESTAURANTE NOT LIKE 'Wikibox' AND FECHA<=TO_DATE('2017-08-02 07:00:00', 'yyyy-MM-dd hh24:mi:ss') AND FECHA>=TO_DATE('2017-07-26 07:00:00', 'yyyy-MM-dd hh24:mi:ss') GROUP BY VALOR  ORDER BY VALOR DESC;



