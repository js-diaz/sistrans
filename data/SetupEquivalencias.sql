DROP TABLE SUSTITUTOS_PRODUCTO;
DROP TABLE SUSTITUTOS_INGREDIENTE;

CREATE TABLE SUSTITUTOS_PRODUCTO
(
    ID_PRODUCTO INTEGER CONSTRAINT SUSTPROD_ID_PRODUCTO_EXISTE NOT NULL,
    ID_SUSTITUTO INTEGER CONSTRAINT SUSTPROD_ID_SUSTITUTO_EXISTE NOT NULL,
    NOMBRE_RESTAURANTE VARCHAR(20) CONSTRAINT SUSTPROD_NOMBRE_RESTAURANTE_EXISTE NOT NULL,
    CONSTRAINT PK_SUSTITUTOS_PRODUCTO PRIMARY KEY (ID_PRODUCTO, ID_SUSTITUTO, NOMBRE_RESTAURANTE),
    CONSTRAINT FK_SUSTPROD_PRODUCTO FOREIGN KEY (ID_PRODUCTO, NOMBRE_RESTAURANTE) REFERENCES INFO_PROD_REST(ID_PRODUCTO, NOMBRE_RESTAURANTE),
    CONSTRAINT FK_SUSTPROD_SUSTITUTO FOREIGN KEY (ID_SUSTITUTO) REFERENCES PRODUCTO(ID)
    CONSTRAINT PROD_NO_SUSTITUIRSE_A_SI_MISMO CHECK NOT ID_PRODUCTO = ID_SUSTITUTO
);

CREATE TABLE SUSTITUTOS_INGREDIENTE
(
    ID_INGREDIENTE INTEGER CONSTRAINT SUSTING_ID_INGREDIENTE_EXISTE NOT NULL,
    ID_SUSTITUTO INTEGER CONSTRAINT SUSTING_ID_SUSTITUTO_EXISTE NOT NULL,
    NOMBRE_RESTAURANTE VARCHAR(20) CONSTRAINT SUSTING_NOMBRE_RESTAURANTE_EXISTE NOT NULL,
    CONSTRAINT PK_SUSTITUTOS_INGREDIENTE PRIMARY KEY (ID_INGREDIENTE, ID_SUSTITUTO, NOMBRE_RESTAURANTE),
    CONSTRAINT FK_SUSTING_INGREDIENTE FOREIGN KEY (ID_INGREDIENTE, NOMBRE_RESTAURANTE) REFERENCES INFO_ING_REST(ID_INGREDIENTE, NOMBRE_RESTAURANTE),
    CONSTRAINT FK_SUSTING_SUSTITUTO FOREIGN KEY (ID_SUSTITUTO) REFERENCES INGREDIENTE(ID)
    CONSTRAINT ING_NO_SUSTITUIRSE_A_SI_MISMO CHECK NOT ID_PRODUCTO = ID_SUSTITUTO
);